<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="676px" preserveAspectRatio="none" style="width:1364px;height:676px;" version="1.1" viewBox="0 0 1364 676" width="1364px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="162" x="604.5" y="11.1387">Crypto Agent Architecture</text><!--MD5=[fac864e77539af95038f0151207ed802]
cluster API--><rect fill="#F8FAFC" height="348" rx="7.5" ry="7.5" style="stroke: #D1D5DB; stroke-width: 1.0;" width="184" x="426.12" y="37.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="479.62" y="51.1074">API Service</text><!--MD5=[2d3af8c67bb090462db5e897d2b3c6b6]
cluster CYBER--><rect fill="#F1F5F9" height="221" rx="7.5" ry="7.5" style="stroke: #D1D5DB; stroke-width: 1.0;" width="350" x="464.12" y="444.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="560.62" y="458.1074">CyberChef Integration</text><!--MD5=[70becb833e031d8ab2b25bb6fd041c2b]
cluster INFRA--><rect fill="#DBEAFE" height="251" rx="7.5" ry="7.5" style="stroke: #D1D5DB; stroke-width: 1.0;" width="188" x="127.12" y="289.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="99" x="171.62" y="303.1074">Infrastructure</text><!--MD5=[7f20aef4c71f84214b8aeef59a0c6c8d]
cluster QUEUE--><rect fill="#F1F5F9" height="96" rx="7.5" ry="7.5" style="stroke: #D1D5DB; stroke-width: 1.0;" width="162" x="974.12" y="37.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="128" x="991.12" y="51.1074">Processing Queue</text><!--MD5=[669688ed79f70020b9301ba1dfb97d55]
entity VAL--><rect fill="#E5E7EB" height="47.9375" rx="7.5" ry="7.5" style="stroke: #D1D5DB; stroke-width: 1.0;" width="130" x="453.12" y="69.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="74" x="463.12" y="91.1074">JSON Parser</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="110" x="463.12" y="105.0762">Schema Validator</text><!--MD5=[7a2008881edc513c866d32deab48a493]
entity DIS--><rect fill="#E5E7EB" height="33.9688" rx="7.5" ry="7.5" style="stroke: #D1D5DB; stroke-width: 1.0;" width="144" x="442.12" y="194.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="124" x="452.12" y="216.1074">Request Dispatcher</text><!--MD5=[61709687e9dcfe6384d9fa3fd2f9ac3f]
entity ENG--><rect fill="#E5E7EB" height="47.9375" rx="7.5" ry="7.5" style="stroke: #D1D5DB; stroke-width: 1.0;" width="131" x="462.62" y="321.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="87" x="472.62" y="343.1074">Crypto Engine</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="111" x="472.62" y="357.0762">OpenSSL 3 + OQS</text><!--MD5=[de0bd2210c6fcc308e0d3516cc9edbc9]
entity RECIPE--><rect fill="#E5E7EB" height="47.9375" rx="7.5" ry="7.5" style="stroke: #D1D5DB; stroke-width: 1.0;" width="135" x="541.62" y="476.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="89" x="551.62" y="498.1074">Recipe Engine</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="115" x="551.62" y="512.0762">Operation Pipeline</text><!--MD5=[d83c920cc05388f55f5f7203d49bcc36]
entity FORMAT--><rect fill="#E5E7EB" height="47.9375" rx="7.5" ry="7.5" style="stroke: #D1D5DB; stroke-width: 1.0;" width="136" x="541.12" y="601.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="109" x="551.12" y="623.1074">Format Converter</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="116" x="551.12" y="637.0762">Base64/Hex/Binary</text><!--MD5=[5e3b9c3bb2dc2c8ecfe43282bb34bdc5]
entity KMS--><rect fill="#BFDBFE" height="47.9375" rx="7.5" ry="7.5" style="stroke: #D1D5DB; stroke-width: 1.0;" width="127" x="143.62" y="321.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="107" x="153.62" y="343.1074">Key Management</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="61" x="153.62" y="357.0762">Vault/KMS</text><!--MD5=[0e1c0c5557d40d9313e6bfb4a7302173]
entity AUDIT--><rect fill="#BFDBFE" height="47.9375" rx="7.5" ry="7.5" style="stroke: #D1D5DB; stroke-width: 1.0;" width="130" x="169.12" y="476.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="79" x="179.12" y="498.1074">Audit Logger</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="110" x="179.12" y="512.0762">Metrics Collection</text><!--MD5=[4f78a2dbd948122154f4c2bad8c30dd8]
entity WORKER--><rect fill="#E5E7EB" height="47.9375" rx="7.5" ry="7.5" style="stroke: #D1D5DB; stroke-width: 1.0;" width="129" x="990.62" y="69.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="84" x="1000.62" y="91.1074">Async Worker</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="109" x="1000.62" y="105.0762">Batch Operations</text><!--MD5=[4a65e84059005d12693a083370a06717]
entity client--><ellipse cx="802.12" cy="317.4688" fill="#374151" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.5;"/><path d="M802.12,325.4688 L802.12,352.4688 M789.12,333.4688 L815.12,333.4688 M802.12,352.4688 L789.12,367.4688 M802.12,352.4688 L815.12,367.4688 " fill="none" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="784.62" y="381.1074">Client</text><!--MD5=[9a9fb86b6b2f428b3be464e14a782164]
link client to VAL--><path d="M809.6,307.8588 C816.03,264.3188 818.98,192.6888 780.12,149.9688 C754.86,122.1988 657.16,107.5788 588.49,100.5688 " fill="none" id="client-&gt;VAL" style="stroke: #6B7280; stroke-width: 2.0;"/><polygon fill="#6B7280" points="583.19,100.0287,591.7445,104.9093,588.1649,100.5291,592.5451,96.9495,583.19,100.0287" style="stroke: #6B7280; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="79" x="863.12" y="209.6074">POST /crypto</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="181" x="812.12" y="223.5762">{operation, algorithm, data}</text><!--MD5=[a7ca734f69c1097ab0843a5345fc1277]
link VAL to DIS--><path d="M493.76,118.2287 C485.92,127.2988 478.21,138.3188 474.12,149.9688 C468.89,164.8887 478.28,179.7688 489.27,191.0988 " fill="none" id="VAL-&gt;DIS" style="stroke: #6B7280; stroke-width: 2.0;"/><polygon fill="#6B7280" points="493.04,194.7987,489.4118,185.6425,489.4689,191.2991,483.8124,191.3562,493.04,194.7987" style="stroke: #6B7280; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="110" x="475.12" y="162.1074">validated request</text><!--MD5=[ba0375da5cfd0d8ee89482442733a1fc]
link DIS to KMS--><path d="M441.77,215.5688 C325.92,220.4788 109.41,233.0487 86.12,258.9688 C62.38,285.4088 99.32,308.3188 138.46,323.8288 " fill="none" id="DIS-&gt;KMS" style="stroke: #6B7280; stroke-width: 2.0;"/><polygon fill="#6B7280" points="143.24,325.6788,136.2801,318.7103,138.5744,323.881,133.4037,326.1753,143.24,325.6788" style="stroke: #6B7280; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="76" x="87.12" y="271.1074">key retrieval</text><!--MD5=[7984c78bb8fe700ea0b1e469f8ae2f57]
link KMS to DIS--><path d="M198.48,321.6688 C193.03,302.5488 189.49,275.9388 204.12,258.9688 C233.55,224.8488 354.64,215.6288 436.48,213.3687 " fill="none" id="KMS-&gt;DIS" style="stroke: #6B7280; stroke-width: 2.0;"/><polygon fill="#6B7280" points="441.82,213.2288,432.7202,209.4614,436.8217,213.3573,432.9258,217.4588,441.82,213.2288" style="stroke: #6B7280; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="118" x="205.12" y="271.1074">cryptographic keys</text><!--MD5=[be38da7c82c75a22bb5434133a2c2ba1]
link DIS to ENG--><path d="M514.06,229.0587 C514.16,241.3888 514.6,258.7888 516.12,273.9688 C517.55,288.1388 520.08,303.7488 522.45,316.7188 " fill="none" id="DIS-&gt;ENG" style="stroke: #6B7280; stroke-width: 2.0;"/><polygon fill="#6B7280" points="523.38,321.7288,525.6663,312.1489,522.4655,316.8131,517.8013,313.6122,523.38,321.7288" style="stroke: #6B7280; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="115" x="517.12" y="271.1074">execute operation</text><!--MD5=[ade92a22e66e3736dbb52d38aec4b491]
link ENG to RECIPE--><path d="M533.14,370.0988 C537.35,387.0088 544.27,410.1888 554.12,428.9688 C562.26,444.4788 573.84,460.0388 584.28,472.6287 " fill="none" id="ENG-&gt;RECIPE" style="stroke: #6B7280; stroke-width: 2.0;"/><polygon fill="#6B7280" points="587.77,476.7788,585.0466,467.3139,584.555,472.9494,578.9196,472.4579,587.77,476.7788" style="stroke: #6B7280; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="136" x="555.12" y="426.1074">CyberChef processing</text><!--MD5=[edf0f1bb607468032d3c38f00393f577]
link RECIPE to FORMAT--><path d="M541.55,523.8888 C517.96,535.4988 500.05,551.6088 512.12,571.9688 C518.69,583.0387 528.48,591.9488 539.35,599.0688 " fill="none" id="RECIPE-&gt;FORMAT" style="stroke: #6B7280; stroke-width: 2.0;"/><polygon fill="#6B7280" points="543.73,601.8088,538.2254,593.6418,539.4924,599.1549,533.9793,600.4219,543.73,601.8088" style="stroke: #6B7280; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="113" x="513.12" y="569.1074">format conversion</text><!--MD5=[edf0f1bb607468032d3c38f00393f577]
link RECIPE to FORMAT--><path d="M622.51,524.9788 C628.81,538.4788 634.31,555.9788 631.12,571.9688 C629.45,580.3788 626.41,589.1388 623.11,597.0488 " fill="none" id="RECIPE-&gt;FORMAT-1" style="stroke: #6B7280; stroke-width: 2.0;"/><polygon fill="#6B7280" points="621.04,601.8488,628.2619,595.1521,623.0096,597.253,620.9087,592.0008,621.04,601.8488" style="stroke: #6B7280; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="126" x="632.12" y="569.1074">data transformation</text><!--MD5=[49f5d56dd3d4018cca78d7342db7405d]
link FORMAT to DIS--><path d="M540.9,619.8488 C425.46,610.2588 197.3,587.0488 127.12,548.9688 C64.06,514.7488 44.83,495.9588 19.12,428.9688 C-9.18,355.1988 9.45,308.3588 71.12,258.9688 C99,236.6388 317.37,222.5788 436.76,216.4887 " fill="none" id="FORMAT-&gt;DIS" style="stroke: #6B7280; stroke-width: 2.0;"/><polygon fill="#6B7280" points="442.02,216.2188,432.8259,212.6876,437.0266,216.4763,433.238,220.677,442.02,216.2188" style="stroke: #6B7280; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="106" x="20.12" y="426.1074">processed result</text><!--MD5=[6d50e6232e7ca6a4eb7d7aa94400c30b]
link DIS to AUDIT--><path d="M445.71,229.0388 C415.28,239.4287 381.37,256.0288 359.12,281.9688 C315.05,333.3688 355.68,371.9788 319.12,428.9688 C307.93,446.4288 291.08,461.7788 275.32,473.6988 " fill="none" id="DIS-&gt;AUDIT" style="stroke: #6B7280; stroke-width: 2.0;"/><polygon fill="#6B7280" points="270.92,476.9688,280.5337,474.8292,274.9388,473.994,275.774,468.3991,270.92,476.9688" style="stroke: #6B7280; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="84" x="360.12" y="350.6074">log operation</text><!--MD5=[5cbec145d074a772d2fb12005867ded5]
link DIS to client--><path d="M561.1,229.0088 C584.26,237.2987 612.45,247.9688 637.12,258.9688 C689.43,282.2788 748.42,314.5488 779.75,332.1888 " fill="none" id="DIS-&gt;client" style="stroke: #6B7280; stroke-width: 2.0;"/><polygon fill="#6B7280" points="784.17,334.6788,778.2955,326.7737,779.8148,332.2227,774.3658,333.742,784.17,334.6788" style="stroke: #6B7280; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="59" x="665.12" y="271.1074">response</text><!--MD5=[221125f9140c224deef9b72f3cdb5183]
link client to RECIPE--><path d="M784.31,361.0888 C752.1,386.6188 683.71,440.8388 642.55,473.4688 " fill="none" id="client-&gt;RECIPE" style="stroke: #6B7280; stroke-width: 2.0;"/><polygon fill="#6B7280" points="638.41,476.7488,647.9433,474.2755,642.3227,473.6357,642.9624,468.0152,638.41,476.7488" style="stroke: #6B7280; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="113" x="718.12" y="426.1074">CyberChef recipes</text><!--MD5=[7c7b8a24b242c468430a5f17ec4e6654]
link FORMAT to client--><path d="M677.18,614.2088 C707.47,606.5888 741.92,593.6888 767.12,571.9688 C821.18,525.3888 823.44,498.3488 840.12,428.9688 C845.05,408.4688 834.34,386.8988 823.05,371.0288 " fill="none" id="FORMAT-&gt;client" style="stroke: #6B7280; stroke-width: 2.0;"/><polygon fill="#6B7280" points="819.86,366.7088,821.9611,376.3309,822.8187,370.7394,828.4101,371.597,819.86,366.7088" style="stroke: #6B7280; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="108" x="838.12" y="505.6074">formatted output</text><!--MD5=[9b3af7538c744a01c53bbf77fa9bc7db]
link DIS to WORKER--><path d="M586.23,195.5088 C690.52,173.1488 882.24,132.0388 985.26,109.9488 " fill="none" id="DIS-&gt;WORKER" style="stroke: #6B7280; stroke-width: 2.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#6B7280" points="990.4,108.8488,980.7645,106.8099,985.5095,109.8896,982.4298,114.6346,990.4,108.8488" style="stroke: #6B7280; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="148" x="785.12" y="162.1074">queue large operations</text><!--MD5=[eadd7486e8ce8b3d71e328b6c66b3d96]
link WORKER to ENG--><path d="M1052.55,118.1788 C1047.94,148.3388 1035.38,200.4987 1002.12,228.9688 C920.79,298.5988 871.13,256.5388 767.12,281.9688 C710.2,295.8888 646,312.8788 598.48,325.7088 " fill="none" id="WORKER-&gt;ENG" style="stroke: #6B7280; stroke-width: 2.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#6B7280" points="593.65,327.0188,603.3816,328.5342,598.4771,325.7153,601.296,320.8108,593.65,327.0188" style="stroke: #6B7280; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="148" x="1029.12" y="216.6074">background processing</text><!--MD5=[f751f710037af982343d7488a264a957]
link WORKER to client--><path d="M1119.78,117.8488 C1176.96,141.7787 1246.51,182.3188 1213.12,228.9688 C1166.46,294.1788 905.22,332.0088 825.34,342.1688 " fill="none" id="WORKER-&gt;client" style="stroke: #6B7280; stroke-width: 2.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#6B7280" points="819.9,342.8588,829.3307,345.6982,824.8605,342.2316,828.3272,337.7614,819.9,342.8588" style="stroke: #6B7280; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="130" x="1222.12" y="216.6074">webhook notification</text><!--MD5=[cbadaff8a48b7afb940f12eac811e1c6]
link KMS to AUDIT--><path d="M198.38,370.1988 C193.37,386.7588 189,409.4488 194.12,428.9688 C198.12,444.2088 206.21,459.6188 214.07,472.1688 " fill="none" id="KMS-&gt;AUDIT" style="stroke: #6B7280; stroke-width: 2.0;"/><polygon fill="#6B7280" points="216.95,476.6588,215.4629,466.9228,214.2527,472.4487,208.7268,471.2385,216.95,476.6588" style="stroke: #6B7280; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="119" x="195.12" y="426.1074">key access logging</text><!--MD5=[acc4d94426b6246de13d4ef8aae627eb]
link ENG to AUDIT--><path d="M483.79,370.0388 C429.81,398.1388 338.92,445.4288 282.97,474.5488 " fill="none" id="ENG-&gt;AUDIT" style="stroke: #6B7280; stroke-width: 2.0;"/><polygon fill="#6B7280" points="278.34,476.9588,288.1699,476.3485,282.7744,474.6488,284.4741,469.2534,278.34,476.9588" style="stroke: #6B7280; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="116" x="400.12" y="426.1074">operation auditing</text><!--MD5=[1739b13d679bc3cbb32285198304ef9a]
@startuml
title Crypto Agent Architecture

skinparam {
  shadowing false
  RoundCorner 15
  BackgroundColor #ffffff
  ArrowThickness 2
  defaultFontSize 12
  ArrowColor #6b7280
}

skinparam rectangle {
  BorderColor #d1d5db
  BorderThickness 1
}

actor "Client" as client #374151

rectangle "API Service" as API #f8fafc {
  rectangle "JSON Parser\nSchema Validator" as VAL #e5e7eb
  rectangle "Request Dispatcher" as DIS #e5e7eb
  rectangle "Crypto Engine\nOpenSSL 3 + OQS" as ENG #e5e7eb
}

rectangle "CyberChef Integration" as CYBER #f1f5f9 {
  rectangle "Recipe Engine\nOperation Pipeline" as RECIPE #e5e7eb
  rectangle "Format Converter\nBase64/Hex/Binary" as FORMAT #e5e7eb
}

rectangle "Infrastructure" as INFRA #dbeafe {
  rectangle "Key Management\nVault/KMS" as KMS #bfdbfe
  rectangle "Audit Logger\nMetrics Collection" as AUDIT #bfdbfe
}

rectangle "Processing Queue" as QUEUE #f1f5f9 {
  rectangle "Async Worker\nBatch Operations" as WORKER #e5e7eb
}

client - -> VAL : POST /crypto\n{operation, algorithm, data}
VAL - -> DIS : validated request
DIS - -> KMS : key retrieval
KMS - -> DIS : cryptographic keys
DIS - -> ENG : execute operation
ENG - -> RECIPE : CyberChef processing
RECIPE - -> FORMAT : format conversion
FORMAT - -> DIS : processed result
DIS - -> AUDIT : log operation
DIS - -> client : response

client - -> RECIPE : CyberChef recipes
RECIPE - -> FORMAT : data transformation
FORMAT - -> client : formatted output

DIS -.-> WORKER : queue large operations
WORKER -.-> ENG : background processing
WORKER -.-> client : webhook notification

KMS - -> AUDIT : key access logging
ENG - -> AUDIT : operation auditing

@enduml

PlantUML version 1.2020.02(Sun Mar 01 12:22:07 EET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 21.0.8+9-Ubuntu-0ubuntu122.04.1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>